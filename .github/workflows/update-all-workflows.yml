name: All workflowüëå

on:
  schedule:
    - cron: '*/10 * * * *'
  workflow_dispatch:

jobs:
  update-schedules:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Update all workflow schedules
        run: |
          cd .github/workflows
          
          # Allworkflow.yml ‡¶õ‡¶æ‡ßú‡¶æ ‡¶∏‡¶¨ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡ßÅ‡¶®
          for file in *.yml; do
            if [ "$file" = "Allworkflow.yml" ]; then
              continue
            fi
            
            echo "Working on: $file"
            
            # ‡¶Ø‡¶¶‡¶ø schedule ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            if grep -q "schedule:" "$file"; then
              sed -i '/cron:/s/.*/    - cron: "\/\*\/10 * * * *"/' "$file"
            else
              # ‡¶Ø‡¶¶‡¶ø schedule ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, 'on:' ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
              sed -i '/^on:/a \  schedule:\n    - cron: "\/\*\/10 * * * *"' "$file"
            fi
          done
      
      - name: Commit changes
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add .
          if ! git diff --cached --quiet; then
            git commit -m "Update all workflows to run every 10 minutes"
            git push
          fi
