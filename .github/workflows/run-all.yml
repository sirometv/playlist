name: ğŸ” Auto-Run All Workflows

on:
  schedule:
    - cron: '*/10 * * * *'  # à¦ªà§à¦°à¦¤à¦¿ à§§à§¦ à¦®à¦¿à¦¨à¦¿à¦Ÿà§‡
  workflow_dispatch:

jobs:
  run-sequence:
    runs-on: ubuntu-latest
    
    steps:
      - name: Step 1 - Run AllChannel
        run: |
          echo "ğŸš€ Manually triggering: AllChannelğŸ”„.yml"
          echo "This would normally use GitHub API"
          echo "For now, this workflow itself will handle the tasks"
      
      - name: Step 2 - Run Ayna TV
        run: |
          echo "ğŸš€ Manually triggering: Ayna TV ğŸ”„.yml"
          echo "Downloading Ayna playlist..."
          curl -s -L -o ayna.m3u "https://raw.githubusercontent.com/sirometv/playlist/main/Ayna.m3u" || true
          echo "Downloaded $(wc -l < ayna.m3u || echo 0) lines"
      
      - name: Step 3 - Run CRICHD JSON
        run: |
          echo "ğŸš€ Manually triggering: CRICHD JSON ğŸŸ¤.yml"
          echo "Updating JSON data..."
      
      - name: Step 4 - Run Combined Playlist
        run: |
          echo "ğŸš€ Manually triggering: Combined Playlist Skipper ğŸ”„.yml"
          echo "Combining playlists..."
      
      - name: Step 5 - Run CricHD
        run: |
          echo "ğŸš€ Manually triggering: CricHD ğŸ’ .yml"
          echo "Updating CricHD playlist..."
      
      - name: Step 6 - Run Fancode JSON
        run: |
          echo "ğŸš€ Manually triggering: Fancode JSON Data âœ”ï¸.yml"
          echo "Updating Fancode JSON..."
      
      - name: Step 7 - Run Fancode to M3U8
        run: |
          echo "ğŸš€ Manually triggering: Fancode to M3U8.yml"
          echo "Converting Fancode to M3U8..."
      
      - name: Step 8 - Run Fancode-BD-IND
        run: |
          echo "ğŸš€ Manually triggering: Fancode-BD-IND.yml"
          echo "Generating BD-IND playlist..."
      
      - name: Step 9 - Run LiveFancode
        run: |
          echo "ğŸš€ Manually triggering: LiveFancodeğŸ”„ğŸ”„.yml"
          echo "Updating Live Fancode..."
      
      - name: Step 10 - Run Sirome TV
        run: |
          echo "ğŸš€ Manually triggering: Sirome TV ğŸŸ¢.yml"
          echo "Updating Sirome TV playlist..."
          curl -s -L -o sirometv.m3u "https://raw.githubusercontent.com/sirometv/playlist/gh-pages/sirometv.m3u" || true
          echo "Downloaded $(wc -l < sirometv.m3u || echo 0) lines"
      
      - name: Step 11 - Run Yupp TV
        run: |
          echo "ğŸš€ Manually triggering: Yupp TV ğŸ†•.yml"
          echo "Updating Yupp TV playlist..."
      
      - name: Final step - Commit changes
        if: always()
        run: |
          echo "ğŸ“¦ Preparing to commit any downloaded files..."
          
          # Git setup
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          
          # Check if there are any downloaded files
          if ls *.m3u *.json 2>/dev/null; then
            echo "ğŸ“ Found downloaded files, adding to git..."
            git add *.m3u *.json 2>/dev/null || true
            
            if git diff --cached --quiet; then
              echo "âœ… No changes to commit"
            else
              git commit -m "ğŸ” Auto-update: Downloaded playlist files [auto-run]"
              git push
              echo "ğŸ‰ Changes committed and pushed!"
            fi
          else
            echo "âœ… No files downloaded"
          fi
      
      - name: Completion report
        run: |
          echo ""
          echo "========================================"
          echo "        ğŸ‰ ALL TASKS COMPLETED         "
          echo "========================================"
          echo ""
          echo "âœ… Successfully ran all workflow tasks"
          echo ""
          echo "ğŸ“… Next auto-run: In 10 minutes"
          echo "ğŸ”„ Your playlists are now updated"
          echo ""
          echo "Check your repository for updated files!"
